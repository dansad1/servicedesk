{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Редактирование типа актива: {{ asset_type.name }}</h2>

    <!-- Форма редактирования типа актива -->
    <form method="post" class="form-horizontal p-3" style="background-color: #f8f9fa; border-radius: 10px;">
        {% csrf_token %}
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="form-group">
                    {{ form.name.label_tag }}
                    {{ form.name }}
                    {% if form.name.errors %}
                    <div class="text-danger">{{ form.name.errors }}</div>
                    {% endif %}
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    {{ form.parent.label_tag }}
                    {{ form.parent }}
                    {% if form.parent.errors %}
                    <div class="text-danger">{{ form.parent.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary">Сохранить изменения</button>
        </div>
    </form>

    <!-- Таблица атрибутов для этого типа актива -->
    <h3 class="mt-5">Атрибуты для типа актива</h3>

    <table class="table table-striped table-bordered mt-3">
        <thead class="thead-dark">
            <tr>
                <th>Имя атрибута</th>
                <th>Тип атрибута</th>
                <th class="text-center">Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for type_attribute in type_attributes %}
            <tr>
                <td>{{ type_attribute.attribute.name }}</td>
                <td>{{ type_attribute.attribute.get_attribute_type_display }}</td>
                <td class="text-center">
                    <a href="{% url 'attribute_edit' type_attribute.attribute.id %}" class="btn btn-primary btn-sm">Редактировать</a>
                    <form method="post" action="{% url 'attribute_delete_from_type' pk=type_attribute.attribute.id asset_type_id=asset_type.id %}" class="d-inline-block" onsubmit="return confirm('Вы уверены, что хотите удалить этот атрибут?');">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm">Удалить</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">Атрибуты не найдены.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Кнопки действий -->
    <div class="text-center mt-4">
        <a href="{% url 'attribute_create' asset_type_id=asset_type.id %}" class="btn btn-success">Добавить новый атрибут</a>
        <a href="{% url 'asset_type_list' %}" class="btn btn-secondary">Вернуться к списку типов активов</a>
    </div>
</div>

{% endblock %}
